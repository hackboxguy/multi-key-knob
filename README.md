# multi-key-knob
![3key1knob-picture](/images/3key1knob.png "3key1knob-picture.")
Alternative firmware for CH552 based [3key-1knob COTS HW](https://amzn.eu/d/6oloNJh). It is Based on [3keys-1knob-firmware](https://github.com/biemster/3keys_1knob) and it allows changing different input-key for rotary knob

- when key-1 is pressed, corresponding Red-LED will turn on and the knob function will be KEY-0/KEY-1
- when key-2 is pressed, corresponding Green-LED will turn on and the knob function will be KEY-2/KEY-3
- when key-3 is pressed, corresponding Blue-LED will turn on and the knob function will be KEY-4/KEY-5

### compile:
`$ make bin`

### compile & flash to pad:
- If on original firmware of OEM: As explained [here](#howto), connect pin-12(UDP) of CH552 to +5V through a 10k resistor to enter bootloader mode
- If on this firmware: press key1 while connecting USB
- `$ make flash`
```
user@machine:~/multi-key-knob$ make flash
Compiling multi-key-knob.c ...
Compiling include/usb_handler.c ...
Compiling include/usb_hid.c ...
Compiling include/delay.c ...
Compiling include/neo.c ...
Compiling include/usb_conkbd.c ...
Compiling include/usb_descr.c ...
Building multi-key-knob.ihx ...
Building multi-key-knob.bin ...
------------------
FLASH: 3205 bytes
IRAM:  26 bytes
XRAM:  274 bytes
------------------
Removing temporary files ...
Uploading to CH55x ...
Connecting to device ...
FOUND: CH552 with bootloader v2.50.
Erasing chip ...
Flashing multi-key-knob.bin to CH552 ...
SUCCESS: 3205 bytes written.
Verifying ...
SUCCESS: 3205 bytes verified.
DONE.
```

### How to overwrite fresh-unit's OEM-Firmware? <a name="howto"></a>
![overwrite-oem-firmware](/images/overwrite-oem-firmware.jpg "overwrite-oem-firmware.")
- As shown above, prepare the setup by connecting a 10k pullup resistor(Pin-12 of CH552) to +5V
- When inserting mini-key-board to USB port of your Linux-Host-PC, ensure Pin-12 of CH552 is pulled up
- On your Linux-Host-PC, run ```make flash```
- Unplug mini-key-board and plug it back to see the effect of modifed opensource firmware(using sudo evtest /dev/input/eventX).
